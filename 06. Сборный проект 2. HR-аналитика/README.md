# Предсказание уровня удовлетворенности и оттока сотрудников

## Описание проекта

HR-аналитики компании «Работа с заботой» помогают бизнесу оптимизировать управление персоналом: бизнес предоставляет данные, а аналитики предлагают, как избежать финансовых потерь и оттока сотрудников.
Компания предоставила данные с характеристиками сотрудников компании. Среди них — уровень удовлетворённости сотрудника работой в компании. Эту информацию получили из форм обратной связи: сотрудники заполняют тест-опросник, и по его результатам рассчитывается доля их удовлетворённости от 0 до 1, где 0 — совершенно неудовлетворён, 1 — полностью удовлетворён. 

**Цель исследования**: предсказать уровень удовлетворённости и возможное увольнение сотрудника на основе данных заказчика, т.к. удовлетворённость работой напрямую влияет на отток сотрудников. А предсказание оттока — одна из важнейших задач HR-аналитиков. Внезапные увольнения несут в себе риски для компании, особенно если уходит важный сотрудник.

**Задачи**:
1. Построить модель, которая сможет предсказать уровень удовлетворённости сотрудника на основе данных заказчика. 
2. Построить модель, которая сможет на основе данных заказчика предсказать то, что сотрудник уволится из компании.

## Вывод

**В ходе реализации проекта было выполнено:**
1. Загрузка данных, изучение информации.
2. Предобработка данных.
3. Исследовательский анализ данных.
4. Составлен портрет "уволившегося сотрудника".
5. Определена зависимость увольнения сотрудников от уровня их удовлетворенности работой.
6. Корреляционный анализ данных.
7. Подготовка данных к моделированию с использованием пайплайна.
8. Обучение и поиск лучшей модели из обученных:
   - Задача 1:
     - создана функция, которая принимает на вход массивы NumPy и возвращает значение метрики SMAPE. Данная метрика была использована при подборе гиперпараметров и оценке качества моделей;
     - обучены 2 модели: DecisionTreeRegressor и LinearRegression;
     - сделан подбор гиперпараметров для моделей с помощью GridSearchCV;
     - найдена лучшая модель с лучшими гиперпараметрами.
   - Задача 2:
     - создадан список словарей для каждой модели. Взяты для обучения 3 модели: DecisionTreeClassifier, KNeighborsClassifier и LogisticRegression. Для компенсации дисбаланса добавлен class_weight='balanced' в конструкторы моделей, которые это поддерживают;
     - для поиска модели с гиперпараметрами использован автоматизированный поиск по сетке GridSearchCV;
     - в качестве оценки качества модели выбрана метрика ROC-AUC.
10. Отбор признаков и их важность:
    - оценена важность признаков для лучшей модели, построен график важности с помощью метода SHAP;
    - создана таблица со всеми признаками, влияющими на предсказания модели, в порядке убывания важности по методу Шепли;
    - отобраны наименее важные признаки, которые были удалены из обучающей выборки;
    - повторно запущено обучение и поиск лучшей модели с гиперпараметрами после удаления признаков.
10. Проверка лучшей модели на адекватность.
11. Даны рекомендации заказчику.
