#  Прогнозирование заказов такси

## Описание проекта

Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Нужно спрогнозировать количество заказов такси на следующий час, чтобы привлекать больше водителей в период пиковой нагрузки.

**Цель проекта:** построить модель для предсказания количество заказов такси на следующий час.

**Критерий качества:** значение метрики *RMSE* на тестовой выборке должно быть не больше 48.

## **Реализация проекта по этапам**:

ЭТАП 1. Подготовка данных:
1. Загрузка данных, изучение информации. 
2. Проверка наличия явных дубликатов.
3. Перезапись файла в датафрейм, назначив даты индексом.
4. Проверка индексов на монотонность (хронологический порядок).
5. Создание функций для визуализации данных.
6. Визуализировано общее распределение заказов и выведены статистические характеристики. 
7. Ресемплирование данных по одному часу и подсчет суммарного значения для каждой группы.

ЭТАП 2. Анализ данных:
1. Построены графики (визуализация) временного ряда, проанализированы статистические характеристики.
2. Декомпозиция данных на трендовую, сезонную составляющие и остаток декомпозиции.
3. Дополнительно сделано ресемплирование по 1 дню для анализа зависимости количества вызовов такси от для недели. 

ЭТАП 3. Обучение моделей:
1. Подготовка данных:
   - создана функция для добавления признаков, необходимых при моделировании. Использованы для моделирования данные, ресэмплированные по 1 часу, т.к. 1 час - это наименьшая единица времени, от которой зависит количество заказов. Т.к. видна суточная и недельная сезонность, взяты параметры, кратные суткам. Функция для создания признаков применена с параметрами: max_lag = 24 - максимальное запаздывание; rolling_mean_size = 24 - окно скользящего среднего. Добавлены признаки: час, день недели, отстающие значения и скользящее среднее;
   - данные разделены на выборки: тренировочную, валидационную и тестовую в соотношении 8:1:1. Отстающие значения и скользящее среднее вычисляются по прошлым данным. Признаки для тестовой и валидационной выборок взяты с конца обучающей выборки, чтобы исключить наличие пропусков (NaN). В тренировочной выборке удалены все строки, в которых имеются пропуски (NaN). Выделены из выборки признаки для обучения: входные и целевой.
2. Модель LightGBM:
   - заданы параметры для автоматического поиска гиперпараметров модели; 
   - с помощью OptunaSearchCV найдены лучшие гиперпараметры для модели градиентного бустинга LightGBM, лучшая модель обучена.

3. Модель LinearRegression:
   - С помощью пайплайна и автоматизированного поиска по сетке было выполнено:
      - кодирование категориальных признаков с помощью OneHotEncoder;
      - перебирался вариант масштабирования количнственных признаков с помощью StandardScaler и MinMaxScaler, и без масштабирования.
   - Найдена лучшая модель, обучена.

4. Модель DecisionTreeRegressor:
   - модель дерева решений не требует масштабирования количественных признаков, поэтому использованы признаки без масштабирования;
   - с помощью автоматизированного поиска GridSearchCV найдены лучшие гиперпараметры для модели DecisionTreeRegressor, лучшая модель обучена.

ЭТАП 4. Тестирование моделей:
Среди трех моделей выбрана лучшая на валидационной выборке, критерий качества (значение метрики) достигнут.
