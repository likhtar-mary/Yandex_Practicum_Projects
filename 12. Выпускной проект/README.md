# Модель прогнозирования оттока клиентов для оператора связи «ТелеДом»

## Описание проекта

Оператор связи «ТелеДом» хочет бороться с оттоком клиентов. Для этого его сотрудники начнут предлагать промокоды и специальные условия всем, кто планирует отказаться от услуг связи. Чтобы заранее находить таких пользователей, «ТелеДому» нужна модель, которая будет предсказывать, разорвёт ли абонент договор. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и услугах. 

**Задача**: создать модель для прогноза оттока клиентов и обучить ее на предоставленных данных.

## Реализация проекта по этапам:

1. Загрузка данных, изучение информации.
2. Предобработка исходных данных.
3. Исследовательский анализ исходных данных:
   - Созданы функции для визуализации признаков:
     - гистограмма и диаграма размаха для количественных непрерывных признаков;
     - барплот (столбчатая диаграмма) для категориальных признаков и дискретных количественных.
   - Визуализированы все признаки из 4 датафреймов. 
4. Объединение данных. Исходные данные из 4 датафреймов объединены в один.
5. Предобработка объединенных данных.
6. Исследовательский анализ объединенных данных:
   - созданы функции для визуализации признаков;
   - визуализированы признаки. 
   - корреляционный анализ данных:
      - построена матрица корреляции признаков с использованием phik и тепловая карта для ее визуализации. 
7. Подготовка данных:
   - данные разделены на выборки: тренировочную и тестовую в соотношении 3:1. Применена стратификация по целевому признаку (из-за дисбаланса классов);
   - подготовка данных:
     - созданы трансформеры, которые включают в себя шаги кодирования категориальных признаков с помощью OneHotEncoder (логистическая регрессия) и OrdinalEncoder (дерево решений и градиентный бустинг), масштабирования MinMaxScaler (стандартизации количественных признаков).
     - итоговый пайплайн будет включать в себя шаги подготовки данных и инициализацию модели на следующем шаге "Обучение моделей".
8. Обучение моделей:
   - создан итоговый пайплайн для каждой модели, включающий в себя шаги подготовки данных и инициализацию соответствующей модели;
   - обучение моделей (LogisticRegression, DecisionTreeClassifier, LGBMClassifier) и поиск лучших гиперпараметров с помощью автоматизированого поиска GridSearchCV, пайплайна, в качестве метрики выбрана ROC-AUC.
9. Выбор лучшей модели:
   - тестирование модели - предсказание на тестовой выборке лучшей моделью;
   - рассчет метрик ROC-AUC и Accuracy на тестовых данных;
   - построена матрица ошибок модели;
   - оценка важности признаков для лучшей модели. Построены графики важности с помощью метода SHAP:
      - влияние признаков на предсказание модели;
      - график общей значимости признаков.

Даны рекомендации заказчику.
